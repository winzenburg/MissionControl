# February 24, 2026 - Trading Strategy Update

## Trend Following (Covel) Analysis for AMS NX

**Source:** Book analysis prepared for AMS Pro Screener NX v2 + Trade Engine NX v2

**Core Finding:** Covel's framework validates most of your AMS NX implementation, but identifies 6 specific gaps where you're leaving meaningful edge on the table.

### Insight 1 — CRITICAL: Stop Taking Predetermined Profit Targets

**Problem:** TP1 at 1.5R and TP2 at 2.5R are capping the right tail of return distribution—this is the disposition effect.

**Evidence from Covel:**
- Top 25% of stocks account for 100% of all market gains (1983–2007)
- Other 75% collectively returned 0%
- Same distribution applies to individual trades in trend-following systems
- Predetermined exits systematically prevent outlier trades from reaching 10R-20R potential

**Quote:** "Thus we do not exit profitable trades at predetermined and (more than likely) premature objectives." — Mulvaney Capital Management

**Recommended Adjustment:**
1. Replace fixed TP1/TP2 with pure trailing stop system (at least for portion of position)
2. Enter full size on signal
3. Trail chandelier stop (you already have this) with NO predetermined profit target
4. Trailing stop is the ONLY exit for profitable trades

**Compromise Option (if certainty needed):**
- Take small partial (20-25%) at 2R to cover commissions + psychological comfort
- Trail remaining 75-80% with NO profit target
- Preserves right tail while reducing anxiety

### Insight 2 — Risk 1-2% Per Trade, Not More

**Problem:** AMS NX Engine lacks explicit per-trade risk percentage input. Position size determined by regime/portfolio DD scale but no hard cap on dollar risk per trade as % of total equity.

**Covel Standard (All CTAs):**
- Risk 2% of equity / dollar risk on trade
- Risk 2% of equity / dollar value of volatility — use LESSER of two

**Recommended Addition:**
- Add `maxRiskPct` input (default 0.02 = 2%)
- Before entry, calculate:
  ```
  riskPerShare = entryPrice - initialStop
  maxShares = (accountEquity * maxRiskPct) / riskPerShare
  ```
- This ensures position sizing scales to equity automatically
- Prevents overleveraging on volatile entries

### Insight 3 — Drawdown Is Not a Bug; It Is the Price of Admission

**Problem:** portfolioDD scaling during drawdowns reduces exposure precisely when recovery is statistically most likely.

**Evidence from Covel:**
- After every major drawdown in JWH's track record (20%+, 25%+, 30%+), system was profitable in 100% of cases 12 months later
- Average returns after major drawdowns: +73–96%
- Reducing position size during recovery means capturing less upside

**Quote:** "Obviously you don't want to overhaul a program in response to one year just because something didn't work. That's when you're almost guaranteed that it would have worked the next year had you kept it in there." — James Klingler, Eclipse Capital

**Recommended Adjustment:**
- Keep portfolioDD as hard circuit breaker for extreme drawdowns (>20%)
- Remove or loosen it for moderate drawdowns (5–15%)
- Data does NOT support reducing size at 5-15% DD levels

### Insight 4 — New All-Time Highs Are a Feature, Not a Red Flag

**Problem:** Current screener uses structOK (Higher Highs / Higher Lows over 20 bars) but doesn't specifically reward 52-week or all-time highs.

**Evidence from Covel:**
- Biggest winning stocks (Cisco, GE, Ford, GM) spent disproportionate time making new multi-year highs while accumulating gains
- Worst-performing stocks spent ZERO time at new highs
- Stock traveling $20 → $300 must cross $30, $40, etc.—spends a lot of time at new highs

**Quote:** "Stock ABC can't typically travel from $20 to $300 without first crossing $30 and $40. Such a stock is going to spend a lot of time making new highs."

**Recommended Addition:**
- Add `useNewHighFilter` input to Screener
- Require: `close >= ta.highest(close, 252)` (52-week high) as confirmation gate for Tier 3 candidates
- This directly implements Covel/Blackstar research

### Insight 5 — Win Rate Is Irrelevant; Mathematical Expectancy Is Everything

**Problem:** zEnter = 0.75 and RSI floor = 50 optimize for win rate, but Covel's framework shows this is the wrong objective.

**Evidence from Covel:**
- Campbell & Co. system profitable only 56% of months but 84% of years, 100% of 4-year rolling windows
- Winners much larger than losers
- Success comes from expectancy ratio, not frequency

**Quote:** "Our trend-following methods do not pretend to determine the value of what we are trading… but they do produce absolute returns fairly consistently." — Jim Little, Campbell & Co.

**Recommended Test:**
- Backtest zEnter = 0.5 vs zEnter = 0.75
- Compare: win rate, average winner / average loser ratio, maximum single-trade return
- If lower threshold produces better expectancy ratio, it is correct even with lower win rate
- Wrong objective: win rate. Right objective: expectancy ratio.

### Insight 6 — Diversification Across Uncorrelated Markets Is the Risk Management

**Problem:** maxAbsCorr = 0.80 against SPY only. Doesn't measure cross-portfolio correlation between open positions. 5 tech stocks each with 0.80 SPY correlation = very high mutual correlation.

**Evidence from Covel:**
- Top trend followers (who use similar systems) have correlations of only 0.33–0.81 with each other
- Differentiation comes entirely from portfolio construction and risk management, NOT signal generation
- Same 25-50 biggest trend followers make money in same places; only portfolio/risk management differs

**Quote:** "The 25 or 50 biggest trend followers are essentially going to make money in the same places. What differentiates them from one another are portfolio and risk management." — Covel

**Recommended Addition:**
- Track number of open positions per sector
- If >30–40% of open positions in same sector, reduce new position size in that sector by 50%
- This is portfolio-level diversification principle—primary differentiator among top trend followers

---

## Implementation Summary

| Insight | Change | Priority | Impact |
|---------|--------|----------|--------|
| 1 | Remove TP1/TP2; trail chandelier stop only (or 20-25% partial at 2R) | CRITICAL | Captures right tail (10R-20R potential) |
| 2 | Add maxRiskPct input; display maxShares in Engine panel | CRITICAL | Prevents overleveraging; scales to equity |
| 3 | Keep portfolioDD only as >20% circuit breaker; loosen 5-15% | HIGH | Captures recoveries with full size |
| 4 | Add useNewHighFilter (52-week high gate) to Screener | HIGH | Focuses on strongest momentum candidates |
| 5 | Backtest zEnter = 0.5; optimize for expectancy, not win rate | MEDIUM | May improve long-term returns |
| 6 | Add sector concentration check; reduce position size if >30-40% in sector | MEDIUM | Reduces portfolio correlation drag |

---

## PHASE 1 Implementation Status — COMPLETE ✅

**Deployed:** Feb 24, 2026, 6:55 PM MT

### Changes Made to nx-engine-monitor-v2.mjs

#### 1. **RiskManager — Added maxRiskPct Input**
- Constructor now takes `maxRiskPct` parameter (default 0.02 = 2%)
- Dynamic maxLossPerTrade calculation: `accountValue * maxRiskPct`
- Position sizing now returns object with:
  - `shares`: calculated max shares
  - `risk`: riskPerShare amount
  - `display`: human-readable max shares string

#### 2. **PositionManager — Removed TP1/TP2, Added Trailing Stop Framework**
- `openPosition()` signature changed:
  - Removed: `targetPrice` parameter
  - Added: `riskPerShare` parameter
  - Now tracks: `partialTarget` (2R for partial exit), `maxPrice`, `partialExited` flag, `trailStopPercent`
  - No predetermined profit target stored
  
- New `partialExit()` method:
  - Exits 20-25% of position at 2R target
  - Keeps remaining 75-80% open with trailing stop
  - Records partial P&L separately
  
- New `checkPartialExit()` method:
  - Monitors 2R target (entryPrice + 2 * riskPerShare)
  - Returns trigger event when 2R is hit
  
- New `checkTrailingStop()` method:
  - Trails stop at 5% below highest price since entry (high-water mark)
  - Only triggers when price drops below trail level
  - Replaces predetermined TP1/TP2 targets completely

#### 3. **Main Monitor Loop — Updated Exit Logic**
- New exit hierarchy (in order):
  1. Check stop loss (full exit at initial stop)
  2. Check partial exit at 2R (sells 25%, keeps 75%)
  3. Check trailing stop on remaining position (full exit if trail hit)
  4. Check exit signal (closes entire position)
  
- Entry logging now displays:
  - Max shares calculation and risk percentage
  - Stop price and risk-per-share amounts
  - Partial target (2R)
  - Trail mechanism explanation
  - Example: `[MAX SHARES @ 2% RISK: 47 shares @ 2% risk]`

### Philosophy Embedded in Code

The implementation directly reflects Covel's core principle:
- **Cutting losses short:** Chandelier stop (5% of entry) is enforced immediately
- **Letting profits run:** No predetermined targets beyond 2R partial; remaining position trails with no upper limit
- **Asymmetric payoff:** System structured to allow 10R-20R winners while capping losses to 5%

### Backtest Instructions

To validate Phase 1 impact:
1. Run screener and engine with PREVIOUS version (with TP1/TP2)
2. Run screener and engine with NEW version (trailing stop only)
3. Compare over 6-month period:
   - Average winner / average loser ratio (should improve significantly)
   - Win rate (may decrease slightly—this is expected)
   - Maximum single-trade return (should be much larger)
   - Sharpe ratio (should improve overall despite lower win rate)

#---

## PHASE 2 Implementation Status — COMPLETE ✅

**Deployed:** Feb 24, 2026, 7:10 PM MT

### Changes Made

#### 1. **screener-executor.mjs — Insight 4: New 52-Week High Filter**

Added `useNewHighFilter` parameter to `isReady()` method:
```javascript
if (useNewHighFilter) {
  const max52w = this.highest(closes, 252); // 52-week high
  if (close < max52w) return false; // Must be at or above 52-week high
}
```

**Application:** For Tier 3 candidates only (highest quality)
- Direct implementation of Covel research: biggest winners (Cisco, GE, Ford, GM) spend disproportionate time at new multi-year highs
- Filters out candidates trending downward from highs
- Added `atNewHigh` flag to candidate results for tracking

#### 2. **screener-executor.mjs — Insight 5: zEnter Parameter**

Added `zEnter` parameter to control entry threshold:
- **Default (zEnter = 50):** RSI must be > 50 (conservative, higher win rate)
- **Lower (zEnter = 40):** RSI must be > 40 (more trades, larger winners)
- **Principle:** Optimize for expectancy ratio, NOT win rate

```javascript
if (score.rsi14 < zEnter) return false; // Configurable entry threshold
```

Added `PHASE2_CONFIG` block at top of screener:
```javascript
const PHASE2_CONFIG = {
  portfolioDD: true,
  useNewHighFilter: true,
  zEnter: 50, // BACKTEST: Try 40, 45, 50, 55
};
```

#### 3. **nx-engine-monitor-v2.mjs — Insight 3: Portfolio Drawdown Logic**

Enhanced `RiskManager` with DD-aware position sizing:

```javascript
getDDMultiplier() {
  const dd = this.calculateDrawdown();
  
  if (dd > 0.20) return 0;        // >20% DD: BLOCK all entries
  if (dd > 0.05 && dd <= 0.15) return 1.0; // 5-15% DD: FULL SIZE (Covel key)
  if (dd <= 0.05) return 1.0;     // <5% DD: Full size
  if (dd > 0.15) return 0.75;     // 15-20% DD: Optional 75% size
}
```

**Key Principle from Covel:** After every major DD in JWH's record, system was profitable in 100% of cases 12 months later with avg returns +73-96%. Reducing size during DD means capturing less of the recovery.

**Application:**
- >20% DD: Hard circuit breaker (NO new entries)
- 5-15% DD: FULL position size (do NOT reduce - recovery is statistically likely)
- <5% DD: Full size
- Track peak equity to calculate current DD percentage

#### 4. **New File: backtest-zenter.mjs**

Created comprehensive backtest framework for Insight 5:
- Tests zEnter values: 40, 45, 50, 55
- Calculates key metrics:
  - Win rate (not primary)
  - Avg winner / avg loser (expectancy ratio - PRIMARY)
  - Max trade return (right tail capture)
  - Sharpe ratio (risk-adjusted returns)
- Provides comparison template and analysis instructions

### Summary Table

| Insight | Change | File | Status |
|---------|--------|------|--------|
| 3 | Portfolio DD logic (circuit breaker + full size in 5-15% DD) | nx-engine-monitor-v2.mjs | ✅ Deployed |
| 4 | New 52-week high filter for Tier 3 candidates | screener-executor.mjs | ✅ Deployed |
| 5 | zEnter parameter + backtest framework | screener-executor.mjs + backtest-zenter.mjs | ✅ Deployed |

### Backtest Instructions (Insight 5)

1. Run current screener (zEnter = 50): `node trading/screener-executor.mjs`
   - Record number of Tier 3 candidates
   - Run trading engine for 3-6 months

2. Update `PHASE2_CONFIG.zEnter = 40` in screener-executor.mjs
   - Run screener again
   - Run trading engine for same period

3. Analyze trades with: `node trading/backtest-zenter.mjs`
   - Compare expectancy ratios (primary metric)
   - Choose configuration with highest ratio
   - Commit optimal value to code

4. Key insight: Lower zEnter (e.g., 40) may have lower win rate but much larger average winner
   - Campbell & Co.: 56% win rate but expectancy >> cost of trades
   - This is the asymmetric payoff Covel emphasizes

### Portfolio DD Logic (Insight 3)

Current equity monitoring:
- Initialized with `peakEquity` parameter in RiskManager
- `calculateDrawdown()` returns (peakEquity - currentEquity) / peakEquity
- `getDDMultiplier()` returns position size scalar based on DD level

Integration point: Before opening positions, call:
```javascript
const sizing = riskMgr.calculatePositionSize(entryPrice, stopPrice, currentDD);
```

Display will show current DD % and size multiplier if applicable.

### Next Steps

1. ✅ **PHASE 1 COMPLETE:** Insight 1 (exits) + Insight 2 (position sizing display)
2. ✅ **PHASE 2 COMPLETE:** Insight 3 (portfolioDD logic) + Insight 4 (new-high filter) + Insight 5 (zEnter backtest)
3. **PHASE 3 (Optional):** Insight 6 (sector concentration check)

---

**Source:** Trend Following (Updated Edition) by Michael W. Covel — Analysis prepared for AMS NX System

**Date Analyzed:** February 24, 2026

---

## THE CORE PRINCIPLE

> "By cutting losses short and letting profits run, an asymmetric payoff profile will develop over the long term with small losses and profits that are few in number but much larger in magnitude."

**Your Current State:**
- ✅ Cutting losses short via chandelier stop
- ❌ NOT fully letting profits run (TP1/TP2 targets are the primary constraint)

**The Strategic Insight:**
Addressing Insight #1 (removing TP1/TP2) is the **highest-leverage change** you can make to the entire system. It is the philosophical foundation upon which all other optimizations build.

Everything else (position sizing, diversification, sector checks, drawdown tolerance) is optimization within this core framework. But the framework itself — asymmetric payoff through short losses and large winners — is what separates trend followers who compound wealth from those who grind sideways or blow up.

**TP1/TP2 is the system's primary ceiling on long-term compounding potential.**

